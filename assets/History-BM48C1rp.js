import{r,j as e,S as R,b as T,L as z}from"./index-ykkmzoko.js";import{G as O,a as M}from"./assets-CT1zWT68.js";import{D as $}from"./SharedServices-9a4KYVb0.js";import{D as F}from"./DisplayResponseAndHistoryComp-rYem8uCg.js";import{T as G}from"./Toast-CVcwi0Uc.js";const y=({defects:x,Components:i,image1:n,image2:c,id:l,userId:w,isCompanyLogin:u,isEngineerView:h,SN:k,role:o,Operator_ID:d,Engineer_ID:v,CreatedAt:t,Pass_Fail:b})=>{const[m,j]=r.useState(!1),[C,N]=r.useState(!0),[S,p]=r.useState(!1),[s,a]=r.useState(""),[f,_]=r.useState(!1),P=g=>{a(g),p(!0)},L=()=>p(!1),B=async(g,D)=>{if(!window.confirm("Do you want to delete this PCB?"))return;await $(g,D)&&P("PCB deleted successfully. Please reload the page.")},H=async(g,D)=>{const E={Engineer_ID:w,Pass_Fail:{Modified_By:w,Status:D,Modified_Time:O()}};R(g,E)&&window.location.reload()},I=g=>H(g,"Pass"),A=g=>H(g,"Repair");return e.jsx("div",{onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),className:"bg-white dark:bg-black p-2 sm:p-5 rounded-xl flex flex-row justify-between gap-2 w-full h-full",children:e.jsxs("div",{className:"w-full flex flex-col gap-2 sm:gap-4 justify-between items-end relative",children:[S&&e.jsx(G,{message:s,onClose:L}),u?e.jsx(F,{defects:x||{},image1:n,components:i||{},image2:c,isCompanyLogin:u,SN:k||"",role:o||"",Operator_ID:d||"",Engineer_ID:v||"",CreatedAt:t||"",Pass_Fail:b||{},isEngineerView:h,magnify:f}):e.jsx(F,{defects:x||{},image1:n,components:i,image2:c,isCompanyLogin:u,magnify:f}),e.jsxs("div",{className:`flex gap-2 absolute right-[50%] top-[-10px] translate-x[50%] bg-second dark:bg-second-dark cursor-pointer px-4 py-2 rounded-full shadow-xl ${m?"opacity-100":"opacity-0"} `,children:[(!u||u&&o==="Leader")&&e.jsx("div",{title:"Delete",onClick:()=>B(l,u),children:e.jsxs("svg",{fill:"#000000",width:"25px",height:"25px",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M831.24 280.772c5.657 0 10.24-4.583 10.24-10.24v-83.528c0-5.657-4.583-10.24-10.24-10.24H194.558a10.238 10.238 0 00-10.24 10.24v83.528c0 5.657 4.583 10.24 10.24 10.24H831.24zm0 40.96H194.558c-28.278 0-51.2-22.922-51.2-51.2v-83.528c0-28.278 22.922-51.2 51.2-51.2H831.24c28.278 0 51.2 22.922 51.2 51.2v83.528c0 28.278-22.922 51.2-51.2 51.2z"}),e.jsx("path",{d:"M806.809 304.688l-58.245 666.45c-.544 6.246-6.714 11.9-12.99 11.9H290.226c-6.276 0-12.447-5.654-12.99-11.893L218.99 304.688c-.985-11.268-10.917-19.604-22.185-18.619s-19.604 10.917-18.619 22.185l58.245 666.45c2.385 27.401 26.278 49.294 53.795 49.294h445.348c27.517 0 51.41-21.893 53.796-49.301l58.244-666.443c.985-11.268-7.351-21.201-18.619-22.185s-21.201 7.351-22.185 18.619zM422.02 155.082V51.3c0-5.726 4.601-10.342 10.24-10.342h161.28c5.639 0 10.24 4.617 10.24 10.342v103.782c0 11.311 9.169 20.48 20.48 20.48s20.48-9.169 20.48-20.48V51.3c0-28.316-22.908-51.302-51.2-51.302H432.26c-28.292 0-51.2 22.987-51.2 51.302v103.782c0 11.311 9.169 20.48 20.48 20.48s20.48-9.169 20.48-20.48z"}),e.jsx("path",{d:"M496.004 410.821v460.964c0 11.311 9.169 20.48 20.48 20.48s20.48-9.169 20.48-20.48V410.821c0-11.311-9.169-20.48-20.48-20.48s-20.48 9.169-20.48 20.48zm-192.435 1.767l39.936 460.964c.976 11.269 10.903 19.612 22.171 18.636s19.612-10.903 18.636-22.171l-39.936-460.964c-.976-11.269-10.903-19.612-22.171-18.636s-19.612 10.903-18.636 22.171zm377.856-3.535l-39.936 460.964c-.976 11.269 7.367 21.195 18.636 22.171s21.195-7.367 22.171-18.636l39.936-460.964c.976-11.269-7.367-21.195-18.636-22.171s-21.195 7.367-22.171 18.636z"})]})}),e.jsx("div",{title:"Magnify",onClick:()=>_(!f),children:f?e.jsx("svg",{width:"25px",height:"25px",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fill:"#000000",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})}):e.jsxs("svg",{width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M15.5 15.5L19 19",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M5 11C5 14.3137 7.68629 17 11 17C12.6597 17 14.1621 16.3261 15.2483 15.237C16.3308 14.1517 17 12.654 17 11C17 7.68629 14.3137 5 11 5C7.68629 5 5 7.68629 5 11Z",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),h&&e.jsxs("div",{className:"mt-2 flex flex-row mb-1 w-full max-w-[400px] min-w-[260px]",children:[e.jsx("button",{onClick:()=>I(l),className:`w-full mr-2 border ${C?"bg-main text-white dark:text-black":"bg-white dark:bg-black text-main"} font-bold py-2 px-4 rounded opacity-90 transition hover:bg-main hover:opacity-100`,children:"Pass"}),e.jsx("button",{onClick:()=>A(l),onMouseEnter:()=>N(!1),onMouseLeave:()=>N(!0),className:"w-full bg-white dark:bg-black text-main border font-bold py-2 px-4 rounded transition hover:bg-main hover:opacity-100 hover:text-white dark:hover:text-black",children:"Repair"})]})]})})},Q=({SN:x,CreatedAt:i,Pass_Fail:n,image1:c,image2:l,id:w,userId:u,Engineer_ID:h})=>{const k=async(v,t)=>{const b=`http://localhost:3002/employees/${v}`;try{const m=await fetch(b);if(!m.ok)throw new Error("Failed to fetch users");const j=await m.json();return j?(t(j.Name),j.Name):(alert("Invalid user. Please try again."),null)}catch(m){console.error("Error logging in:",m)}},[o,d]=r.useState();return r.useEffect(()=>{k(h,d)},[]),e.jsx("div",{className:"bg-white dark:bg-black  p-2 sm:p-5 rounded-xl flex flex-row justify-between gap-2 w-full h-full",children:e.jsx("div",{className:"w-full flex flex-col gap-2 sm:gap-4 justify-between relative items-end",children:e.jsx("div",{className:" w-full flex flex-col sm:flex-row justify-between items-center",children:(c||l)&&e.jsxs("div",{className:"flex flex-row w-full justify-between flex-wrap items-center gap-2.5",children:[e.jsxs("div",{className:"w-fit",children:[e.jsxs("p",{className:"text-xl text-title",children:["SN: ",x]}),e.jsxs("p",{className:"text-xl text-title",children:["Created at : ",i]}),e.jsxs("p",{className:"text-xl text-title",children:["Status : ",n.Status]}),e.jsxs("p",{className:"text-xl text-title",children:[n.Status!=="Pending"&&"Engineer : "+o," "]}),e.jsxs("p",{className:"text-xl text-title",children:[n.Status!=="Pending"&&"Modified Time : "+n.Modified_Time," "]})]}),e.jsxs("div",{className:"images flex flex-row gap-1.5 flex-wrap w-fit justify-end ml-auto",children:[c&&e.jsx("img",{src:c,alt:"pcb",className:"w-76 "}),l&&e.jsx("img",{src:l,alt:"pcb",className:"w-76"})]})]})})})})},W=({onStatusChange:x,onSearchChange:i,initialStatus:n="All"})=>{const[c,l]=r.useState(!1),[w,u]=r.useState(n),[h,k]=r.useState(""),o=r.useRef(null),d=[{value:"All",label:"All"},{value:"Pass",label:"Pass"},{value:"Repair",label:"Repair"},{value:"Pending",label:"Pending"}];r.useEffect(()=>{function t(b){o.current&&!o.current.contains(b.target)&&l(!1)}return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),r.useEffect(()=>{const t=setTimeout(()=>{i(h)},300);return()=>clearTimeout(t)},[h,i]);const v=t=>{u(t),x(t),l(!1)};return e.jsxs("div",{className:"bg-second dark:bg-second-dark flex flex-row justify-between gap-2 w-full h-full",children:[e.jsxs("div",{className:"flex flex-row bg-white dark:bg-black p-2 rounded-xl gap-2 w-full max-w-80",children:[e.jsxs("svg",{fill:"#777777",height:"30px",width:"30px",version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"-49 -49 588.00 588.00",xmlSpace:"preserve",stroke:"#000000",strokeWidth:"2.45",children:[e.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),e.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("g",{id:"SVGRepo_iconCarrier",children:e.jsx("path",{d:"M437.588,202.053C437.588,90.634,344.307,0,229.643,0S21.683,90.634,21.683,202.053s93.296,202.068,207.96,202.068 c43.421,0,83.744-13.04,117.128-35.243L456.982,490l11.335-10.318L359.242,359.809C406.918,322.749,437.588,265.857,437.588,202.053 z M229.643,388.809c-106.23,0-192.647-83.785-192.647-186.756S123.412,15.313,229.643,15.313 c106.216,0,192.633,83.77,192.633,186.741S335.858,388.809,229.643,388.809z"})})]}),e.jsx("input",{type:"text",placeholder:"Search with SN...",className:"w-full h-full outline-none border-none caret-main text-[#777777] font-medium",value:h,onChange:t=>k(t.target.value)})]}),e.jsxs("div",{className:"w-full max-w-50 bg-white dark:bg-black rounded-xl p-2 relative",ref:o,children:[e.jsxs("div",{className:"outline-none border-none text-[#777777] font-medium w-full cursor-pointer flex justify-between items-center",onClick:()=>l(!c),children:[w,e.jsx("svg",{className:`w-4 h-4 ml-2 transition-transform ${c?"rotate-180":""}`,fill:"#777777",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),c&&e.jsx("div",{className:"absolute left-0 z-10 mt-1 w-full bg-white dark:bg-black rounded-md shadow-lg border border-gray-200",children:d.map(t=>e.jsx("div",{className:`px-4 py-2 text-[#777777] font-medium cursor-pointer hover:bg-main hover:text-white transition-colors ${w===t.value?"bg-gray-100":""}`,onClick:()=>{v(t.value),l(!1)},children:t.label},t.value))})]})]})},J=({isCompanyLogin:x,role:i,isEngineerView:n,employeeId:c,history:l,userHistoryLoading:w,userHistoryError:u,navigateTo:h,isHistory:k,Line_ID:o})=>{const[d,v]=r.useState("All"),[t,b]=r.useState(""),[m,j]=r.useState([]),[C,N]=r.useState(!1),S=()=>!l||l.length===0?[]:x&&n?l.filter(s=>{var a,f;return s.Line_ID===o&&(s.Defects&&((a=s.Pass_Fail)==null?void 0:a.Status)==="Pending"||s.Components&&((f=s.Pass_Fail)==null?void 0:f.Status)==="Pending")}):o?l.filter(s=>s.Line_ID===o):l;if(r.useEffect(()=>{const s=S();let a=[];t||d!=="All"?(a=s.filter(f=>{const _=d==="All"||f.Pass_Fail&&f.Pass_Fail.Status===d,P=!t||f.SN&&f.SN.toLowerCase().includes(t.toLowerCase());return _&&P}),N((t||d!=="All")&&a.length===0)):(a=s,N(!1)),j(a)},[d,t,l,o,n]),u)return e.jsx("div",{className:"max-w-screen-xl mx-auto flex flex-col w-full h-full",children:e.jsx("div",{className:"bg-second dark:bg-second-dark p-2 sm:p-5 w-full",children:e.jsxs("div",{className:"bg-white dark:bg-black rounded-xl w-full h-full flex flex-col items-center justify-center gap-2",children:[e.jsx("img",{src:M.not_found,alt:"empty",title:"click to add history",className:"w-full"}),e.jsxs("p",{className:"p-2 bg-white dark:bg-black",children:["Error: ",u]})]})})});const p=m.length>0?m:t||d!=="All"?[]:S();return e.jsxs("div",{className:`max-w-screen-xl mx-auto flex flex-col w-full h-full fixed_direction ${!n&&"mt-7"}`,children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("u",{className:"text-lg font-[400] text-sub-text",children:n?"Defective PCBS":"History"}),e.jsxs("p",{className:"text-lg font-[400] text-sub-text",children:[p.length," Boards"]})]}),w?e.jsx("div",{className:"bg-second dark:bg-second-dark p-2 sm:p-5 w-full h-full flex justify-center items-center flex-col",children:e.jsx("div",{className:"p-2 sm:p-5 bg-white dark:bg-black rounded-xl w-full h-full",children:e.jsx(T,{})})}):e.jsxs("div",{className:"bg-second dark:bg-second-dark p-2 sm:p-5 w-full h-full flex flex-col gap-5 ",children:[i==="Leader"&&e.jsx(W,{onStatusChange:v,onSearchChange:b,initialStatus:d}),C?e.jsxs("div",{className:"bg-white dark:bg-black rounded-xl w-full h-full flex flex-col items-center justify-center gap-2",children:[e.jsx("img",{src:M.empty,alt:"empty",title:"No matching results found"}),e.jsx("h1",{className:"text-sub-text",children:"No matching results found"})]}):p.length>0?e.jsx("div",{className:"w-full flex flex-col gap-5",children:x?e.jsxs(e.Fragment,{children:[i==="Operator"&&p.map((s,a)=>e.jsx("div",{children:e.jsx(Q,{image1:s.image1,image2:s.image2,id:s.id,userId:s.Operator_ID,SN:s.SN,CreatedAt:s.CreatedAt,Pass_Fail:s.Pass_Fail,Engineer_ID:s.Engineer_ID})},a)),n&&p.map((s,a)=>e.jsx("div",{children:e.jsx(y,{SN:s.SN,defects:s.Defects,Components:s.Components,image1:s.image1,image2:s.image2,id:s.id,userId:c,isCompanyLogin:x,isEngineerView:!0,role:i})},a)),i==="Engineer"&&!n&&p.map((s,a)=>e.jsx("div",{children:e.jsx(y,{SN:s.SN,defects:s.Defects,Components:s.Components,image1:s.image1,image2:s.image2,id:s.id,userId:c,isCompanyLogin:x,role:i,isEngineerView:!1,Pass_Fail:s.Pass_Fail})},a)),i==="Leader"&&p.map((s,a)=>e.jsx("div",{children:e.jsx(y,{SN:s.SN,Operator_ID:s.Operator_ID,Engineer_ID:s.Engineer_ID,CreatedAt:s.CreatedAt,Pass_Fail:s.Pass_Fail,defects:s.Defects,Components:s.Components,image1:s.image1,image2:s.image2,id:s.id,userId:c,isCompanyLogin:x,role:i,isEngineerView:!1})},a))]}):p.map((s,a)=>e.jsx("div",{children:e.jsx(y,{defects:s.Defects,Components:s.Components,image1:s.image1,image2:s.image2,id:s.id,isCompanyLogin:!1,isHistory:!0,PCB:s})},a))}):e.jsxs(z,{to:h,className:"bg-white dark:bg-black rounded-xl w-full h-full flex flex-col items-center justify-center gap-2",children:[e.jsx("img",{src:M.empty,alt:"empty",title:"click to add history"}),e.jsx("h1",{title:"click to add history",children:"No history..."})]})]})]})};export{J as H};
